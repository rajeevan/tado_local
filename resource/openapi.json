{"openapi":"3.1.0","info":{"title":"Tado Local","description":"Local REST API for Tado devices via HomeKit bridge","version":"1.0.0-alpha1"},"paths":{"/api":{"get":{"tags":["Info"],"summary":"Api Info","description":"API root with diagnostics and navigation.","operationId":"api_info_api_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/status":{"get":{"tags":["Status"],"summary":"Get Status","description":"Get overall system status.","operationId":"get_status_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/accessories":{"get":{"tags":["HomeKit"],"summary":"Get Accessories","description":"Get all HomeKit accessories and their characteristics.\n\nArgs:\n    enhanced: If True, include human-readable names for UUIDs (default: True)","operationId":"get_accessories_accessories_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"enhanced","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Enhanced"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/accessories/{accessory_id}":{"get":{"tags":["HomeKit"],"summary":"Get Accessory","description":"Get specific accessory by ID.\n\nArgs:\n    accessory_id: The HomeKit accessory ID\n    enhanced: If True, include human-readable names for UUIDs (default: True)","operationId":"get_accessory_accessories__accessory_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"accessory_id","in":"path","required":true,"schema":{"type":"integer","title":"Accessory Id"}},{"name":"enhanced","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Enhanced"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/thermostats":{"get":{"tags":["Thermostats"],"summary":"Get Thermostats","description":"Get all thermostat devices with standardized state.\n\nReturns temperature, humidity, mode, and heating status for each thermostat.","operationId":"get_thermostats_thermostats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/thermostats/{thermostat_id}":{"get":{"tags":["Thermostats"],"summary":"Get Thermostat","description":"Get specific thermostat by device ID with standardized state.","operationId":"get_thermostat_thermostats__thermostat_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"thermostat_id","in":"path","required":true,"schema":{"type":"integer","title":"Thermostat Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/zones":{"get":{"tags":["Zones"],"summary":"Get Zones","description":"Get all zones with aggregated state (no per-device details).\n\nReturns zone-level information:\n- Current temperature (°C and °F)\n- Current humidity (%)\n- Target temperature (°C and °F)\n- Mode (0=Off, 1=Heat) - TargetHeatingCoolingState\n- Currently heating (0=Off, 1=Heating, 2=Cooling) - CurrentHeatingCoolingState\n\nNote: Mode values depend on device capabilities. Heating-only devices typically\nsupport 0 (Off) and 1 (Heat). Devices with cooling may support additional values.\n\nFor individual device details, use /thermostats or /devices endpoints.\n\nNote: For zones where the leader is a circuit driver (e.g., RU02 controlling\nmultiple rooms), the \"cur_heating\" status reflects the actual heating\nstate from radiator valves in the zone, not the circuit driver state.","operationId":"get_zones_zones_get","security":[{"HTTPBearer":[]}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["Zones"],"summary":"Create Zone","description":"Create a new zone.","operationId":"create_zone_zones_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"name","in":"query","required":true,"schema":{"type":"string","title":"Name"}},{"name":"leader_device_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Leader Device Id"}},{"name":"order_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Order Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/zones/{zone_id}":{"get":{"tags":["Zones"],"summary":"Get Zones","description":"Get zone level information\n\nReturns zone-level information:\n- Current temperature (°C and °F)\n- Current humidity (%)\n- Target temperature (°C and °F)\n- Mode (0=Off, 1=Heat) - TargetHeatingCoolingState\n- Currently heating (0=Off, 1=Heating, 2=Cooling) - CurrentHeatingCoolingState\n\nNote: Mode values depend on device capabilities. Heating-only devices typically\nsupport 0 (Off) and 1 (Heat). Devices with cooling may support additional values.\n\nFor individual device details, use /thermostats or /devices endpoints.\n\nNote: For zones where the leader is a circuit driver (e.g., RU02 controlling\nmultiple rooms), the \"cur_heating\" status reflects the actual heating\nstate from radiator valves in the zone, not the circuit driver state.","operationId":"get_zones_zones__zone_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"zone_id","in":"path","required":true,"schema":{"type":"integer","title":"Zone Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Zones"],"summary":"Update Zone","description":"Update a zone.","operationId":"update_zone_zones__zone_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"zone_id","in":"path","required":true,"schema":{"type":"integer","title":"Zone Id"}},{"name":"name","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"}},{"name":"leader_device_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Leader Device Id"}},{"name":"order_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Order Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/zones/{zone_id}/set":{"post":{"tags":["Zones"],"summary":"Set Zone","description":"Control a zone's heating via its leader device.\n\nArgs:\n    zone_id: Zone ID to control\n    temperature: Target temperature in °C (-1, 0, or 5-30).\n                - -1 = resume schedule/auto mode (enable heating without changing target temp)\n                - 0 = disable heating (without changing target temp)\n                - >= 5 = set temperature and enable heating\n    heating_enabled: Enable/disable heating mode (true/false)\n\nReturns:\n    Success status and applied values\n\nNotes:\n    - Smart defaults:\n      - temperature = -1 implies heating_enabled=true (resume schedule)\n      - temperature = 0 implies heating_enabled=false (off)\n      - temperature >= 5°C implies heating_enabled=true\n    - Explicitly set heating_enabled to override smart defaults\n    - Commands are sent to the zone's leader device\n    - The leader propagates changes to other devices as needed\n    - heating_enabled controls the heat mode (OFF=0, HEAT=1)\n    - Both temperature=0 and temperature=-1 preserve the stored target temperature\n    - This allows temporary on/off control without affecting your schedule\n    - temperature=-1 is useful for automation: turn on without changing schedule\n    - temperature=0 is useful for \"away mode\": turn off but remember setpoint","operationId":"set_zone_zones__zone_id__set_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"zone_id","in":"path","required":true,"schema":{"type":"integer","title":"Zone Id"}},{"name":"temperature","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Temperature"}},{"name":"heating_enabled","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Heating Enabled"}},{"name":"no_implicit_mode","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":false,"title":"No Implicit Mode"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/devices":{"get":{"tags":["Devices"],"summary":"Get Devices","description":"Get all registered devices with standardized state.\n\nReturns all devices (thermostats, valves, bridges, etc.) with:\n- Device metadata (serial, type, zone)\n- Standardized state format\n- Battery status (for battery-powered devices)","operationId":"get_devices_devices_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/devices/{device_id}":{"get":{"tags":["Devices"],"summary":"Get Device","description":"Get specific device with standardized state by ID (database device_id).\n\nArgs:\n    device_id: Device ID (database ID)","operationId":"get_device_devices__device_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"device_id","in":"path","required":true,"schema":{"type":"integer","title":"Device Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/devices/{device_id}/history":{"get":{"tags":["Devices"],"summary":"Get Device History","description":"Get device state history.\n\nArgs:\n    device_id: Device ID\n    start_time: Start timestamp (Unix epoch)\n    end_time: End timestamp (Unix epoch)\n    limit: Maximum number of records to return (default: 100)\n    offset: Number of records to skip for pagination (default: 0)\n\nReturns:\n    List of historical state snapshots with standardized state format.\n    Each record contains a 'state' object (matching /devices format) and 'timestamp'.","operationId":"get_device_history_devices__device_id__history_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"device_id","in":"path","required":true,"schema":{"type":"integer","title":"Device Id"}},{"name":"start_time","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Start Time"}},{"name":"end_time","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"End Time"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/devices/{device_id}/set":{"post":{"tags":["Devices"],"summary":"Set Device","description":"Standardized control endpoint for device heating.\n\nArgs:\n    device_id: Device ID to control\n    temperature: Target temperature in °C (0-30).\n                - 0 = disable heating (implies heating_enabled=false)\n                - >= 5 = enable heating (implies heating_enabled=true unless explicitly set to false)\n    heating_enabled: Enable/disable heating mode (true/false)\n\nReturns:\n    Success status and applied values\n\nNotes:\n    - Smart defaults:\n      - temperature = 0 implies heating_enabled=false\n      - temperature >= 5°C implies heating_enabled=true\n    - Commands are forwarded to the device's zone leader\n    - If device is not in a zone, direct control is attempted","operationId":"set_device_devices__device_id__set_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"device_id","in":"path","required":true,"schema":{"type":"integer","title":"Device Id"}},{"name":"temperature","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Temperature"}},{"name":"heating_enabled","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Heating Enabled"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/devices/{device_id}/zone":{"put":{"tags":["Devices"],"summary":"Assign Device To Zone","description":"Assign a device to a zone (or remove from zone if zone_id is None).","operationId":"assign_device_to_zone_devices__device_id__zone_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"device_id","in":"path","required":true,"schema":{"type":"integer","title":"Device Id"}},{"name":"zone_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Zone Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/thermostats/{thermostat_id}/history":{"get":{"tags":["Thermostats"],"summary":"Get Thermostat History","description":"Get thermostat state history (forwarded to device history).\n\nArgs:\n    thermostat_id: Thermostat device ID\n    start_time: Start timestamp (Unix epoch)\n    end_time: End timestamp (Unix epoch)\n    limit: Maximum number of records to return (default: 100)\n    offset: Number of records to skip for pagination (default: 0)","operationId":"get_thermostat_history_thermostats__thermostat_id__history_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"thermostat_id","in":"path","required":true,"schema":{"type":"integer","title":"Thermostat Id"}},{"name":"start_time","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Start Time"}},{"name":"end_time","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"End Time"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/thermostats/{thermostat_id}/set":{"post":{"tags":["Thermostats"],"summary":"Set Thermostat","description":"Standardized control endpoint for thermostat heating.\n\nArgs:\n    thermostat_id: Thermostat device ID to control\n    temperature: Target temperature in °C (0-30).\n                - 0 = disable heating (implies heating_enabled=false)\n                - >= 5 = enable heating (implies heating_enabled=true unless explicitly set to false)\n    heating_enabled: Enable/disable heating mode (true/false)\n\nReturns:\n    Success status and applied values\n\nNotes:\n    - Smart defaults:\n      - temperature = 0 implies heating_enabled=false\n      - temperature >= 5°C implies heating_enabled=true\n    - Commands are forwarded to the device's zone leader\n    - Alias for /devices/{id}/set with thermostat-specific naming","operationId":"set_thermostat_thermostats__thermostat_id__set_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"thermostat_id","in":"path","required":true,"schema":{"type":"integer","title":"Thermostat Id"}},{"name":"temperature","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Temperature"}},{"name":"heating_enabled","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Heating Enabled"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/zones/{zone_id}/history":{"get":{"tags":["Zones"],"summary":"Get Zone History","description":"Get zone state history via the zone's leader device.\n\nArgs:\n    zone_id: Zone ID\n    start_time: Start timestamp (Unix epoch)\n    end_time: End timestamp (Unix epoch)\n    limit: Maximum number of records to return (default: 100)\n    offset: Number of records to skip for pagination (default: 0)\n\nNotes:\n    - Returns history from the zone's leader device\n    - Leader device represents the canonical state for the zone\n    - For circuit drivers (e.g., RU02) with radiator valves:\n      * Temperature/humidity history is accurate (from circuit driver sensor)\n      * Heating history shows circuit driver state (may indicate heating for entire circuit,\n        not just this zone)\n      * This is a known limitation: showing circuit-wide heating is better than showing none","operationId":"get_zone_history_zones__zone_id__history_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"zone_id","in":"path","required":true,"schema":{"type":"integer","title":"Zone Id"}},{"name":"start_time","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Start Time"}},{"name":"end_time","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"End Time"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/events":{"get":{"tags":["Events"],"summary":"Get Events","description":"Server-Sent Events (SSE) endpoint for real-time updates.\n\nArgs:\n    refresh_interval: Optional interval in seconds to send periodic refresh updates\n                    even when state hasn't changed. Useful for clients like Domoticz\n                    that need regular updates for statistics and \"last seen\" tracking.\n                    Recommended: 300 (5 minutes). Default: None (only send on changes).\n    types: Optional comma-separated list of event types to filter (e.g., \"zone,device\" or \"zone\").\n           If not specified, all event types are sent.\n\nClients can maintain a persistent connection to receive live updates without polling.\n\nEvent Types:\n\n1. Device State Change:\n   {\n       \"type\": \"device\",\n       \"device_id\": 4,\n       \"serial\": \"RU1372921856\",\n       \"zone_name\": \"Studeerkamer\",\n       \"state\": {\n           \"cur_temp_c\": 21.5,\n           \"cur_temp_f\": 70.7,\n           \"hum_perc\": 55,\n           \"target_temp_c\": 21.0,\n           \"target_temp_f\": 69.8,\n           \"mode\": 1,\n           \"cur_heating\": 1,\n           \"valve_position\": 45,\n           \"battery_low\": false\n       },\n       \"timestamp\": 1730477890.123\n   }\n\n2. Zone State Change:\n   {\n       \"type\": \"zone\",\n       \"zone_id\": 4,\n       \"zone_name\": \"Studeerkamer\",\n       \"state\": {\n           \"cur_temp_c\": 21.5,\n           \"cur_temp_f\": 70.7,\n           \"hum_perc\": 55,\n           \"target_temp_c\": 21.0,\n           \"target_temp_f\": 69.8,\n           \"mode\": 1,\n           \"cur_heating\": 1\n       },\n       \"timestamp\": 1730477890.123\n   }\n\n3. Keepalive (every 90 seconds for connections without refresh_interval):\n   {\n       \"type\": \"keepalive\",\n       \"timestamp\": 1730477890.123\n   }\n\nNote: Connections with refresh_interval don't receive keepalives - refresh events\nact as keepalives. This reduces unnecessary traffic for clients like Domoticz.\n\nState Field Reference:\n    mode: 0=Off, 1=Heat, 2=Cool, 3=Auto (TargetHeatingCoolingState)\n    cur_heating: 0=not heating, 1=actively heating (CurrentHeatingCoolingState)\n    battery_low: true if Cloud API battery_state != \"NORMAL\" (cached, no DB queries)\n    Temperatures provided in both Celsius (_c) and Fahrenheit (_f)\n\nUsage Example:\n    const eventSource = new EventSource('/events');\n    eventSource.onmessage = (event) => {\n        const data = JSON.parse(event.data);\n\n        if (data.type === 'zone') {\n            // Update zone UI\n            updateZone(data.zone_id, data.state);\n        } else if (data.type === 'device') {\n            // Update device UI (if showing device details)\n            updateDevice(data.device_id, data.state);\n        }\n    };","operationId":"get_events_events_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"refresh_interval","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Refresh Interval"}},{"name":"types","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Types"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/refresh":{"post":{"tags":["Admin"],"summary":"Refresh Data","description":"Manually refresh accessories data from HomeKit bridge.","operationId":"refresh_data_refresh_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/refresh/cloud":{"post":{"tags":["Admin"],"summary":"Refresh Cloud Data","description":"Manually refresh data from Tado Cloud API.\n\nArgs:\n    battery_only: If true, only refresh battery/status data (fast).\n                 If false, refresh all data including config (slower).\n\nReturns:\n    Summary of refreshed data\n\nThis bypasses the cache and fetches fresh data from Tado's servers.\nUseful when you need immediate battery status updates or after making\nchanges in the Tado app.","operationId":"refresh_cloud_data_refresh_cloud_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"battery_only","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Battery Only"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}